# kitti2cocojson
A basic tool for converting Kitti object annotations to bbox annotation for LiDAR bird-eye-view object detection in coco JSON format.

ATTENTION: the conversion does not take bounding boxes inside camera images into account. This project uses bird-eye-view LiDAR coordinate system (2D) and all bbox coordinate references should be inside LiDAR frame.

## Kitti Labels
Kitti provides annotations in txt format for every frame. Every line in annotation file represents an object with 15 elements as shown in the this table. The first element is object class and the last element is bounding box rotation angle around vertical axis in camera 3D coordinate system.

<img width="693" alt="kitti_labels" src="https://user-images.githubusercontent.com/35779029/170735579-9da9c754-2615-4da9-ba7f-e17bff8ea5de.png">

## Sensor Coordinates
Kitti spatial references (even for 3D bounding boxes) are all in camera coordinate system. A one dimension CAM2LiDAR transformation would be required if annotations are used within Velodyne pointcloud data. This transformation should take place on "z" axis within camera frame.

<img width="694" alt="kitti_frames" src="https://user-images.githubusercontent.com/35779029/170731925-93c43497-4365-4f71-bd89-1ff3772c3663.png">

## Usage

### Prepare input annotation
Clone the repository. You already have folder "data" with "train/test/val" splits. Modify the splits as you want. Create a new folder called "annotations"  in which you put all Kitti label files (download labels from [Kitti 3D object detection dataset](http://www.cvlibs.net/datasets/kitti/eval_object.php?obj_benchmark=3d)). Finally, create an empty folder for output JSON files and name it "json".

### Start annotation format conversion

run "convert.m". The script will first read the name of frames for "train/test/val" splits and generates a separate annotation JSON file (inside folder "json") for each and every split. Annotation generated by the script follow COCO JSON FORMAT (example below):

<img width="847" alt="coco" src="https://user-images.githubusercontent.com/35779029/170732913-5dee6175-225f-4838-9203-a84884fc80ad.png">



